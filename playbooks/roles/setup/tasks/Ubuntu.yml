---

- name: remove /var/crash/*
  become: yes
  file:
    name: /var/crash/*
    state: absent

- name: set timezone
  become: yes
  timezone:
    name: Asia/Tokyo

- name: change /etc/nsswitch.conf
  become: yes
  lineinfile:
    path: /etc/nsswitch.conf
    regexp: '^(.*) \[NOTFOUND=return\] (.*)$'
    line: '\1 \2'
    backrefs: yes

- name: change ubuntu repository url
  become: yes
  replace:
    dest: /etc/apt/sources.list
    regexp: 'http://(.*\.)?archive\.ubuntu\.com/ubuntu/'
    replace: 'http://jp.archive.ubuntu.com/ubuntu/'
  register: ubuntu_repo

- name: add ubuntu japanese team repository
  become: yes
  apt_repository:
    repo: 'ppa:japaneseteam/ppa'
  register: ubuntu_ja_repo

- name: update repositories
  become: yes
  apt:
    update_cache: yes
  when: ubuntu_repo is changed or ubuntu_ja_repo is changed
